{{ define "main" }}
  {{ $slug := .Slug }}
  {{ $programsForTeacher := index site.Taxonomies.teachers $slug}}
  {{ $programsForAdministrator := index site.Taxonomies.administrators $slug}}
  {{ $programsForTeacherAndAdministrator := union $programsForTeacher $programsForAdministrator }}
  {{ $author := site.GetPage (printf "/authors/%s" $slug) }}
  <header class="hero">
    <div class="container">
      <div class="row">
        <div class="col-md-10">
          <h1>{{ safeHTML (partial "CorrectPunctuation" .Title) }}</h1>
        </div>
        <div class="col-md-2">
          <div class="avatar">
            {{ if .Params.image }}
              {{ partial "commons/image.html"
                    (dict
                      "alt"    .Title
                      "image"    .Params.image
                      "class"    "img-fluid"
                      "mobile"   "100x100"
                      "tablet"   "152x152"
                      "desktop"  "152x152"
                    )}}
            {{ end }}
          </div>
        </div>
      </div>
      <div class="hero__nav">
        {{ partial "header/breadcrumbs.html" (dict "context" .) }}
      </div>
    </div>
  </header>
  <div class="container">
    <div class="row mb-6">
      {{ if .Content }}
        <div class="col-md-8">
          <p class="lead">
            <em>
              {{ safeHTML (partial "CorrectPunctuation" .Content) }}
            </em>
          </p>
        </div>
        <div class="col-md-4">
          {{ range $programsForTeacherAndAdministrator }}
            {{ $program := . }}
            {{ range .Params.roles }}
              {{ $role := .title }}
              {{ if in .persons $slug }}
                {{ safeHTML $role }}
                <a href="{{ $program.Permalink }}" class="link link--more">{{ safeHTML $program.Title }}</a>
              {{ end }}
            {{ end }}
          {{ end }}
        </div>
        {{ end }}
    </div>

    {{ if $programsForTeacher }}
      <section class="mb-6">
        <div class="top">
          <h2>{{ i18n "persons.programs" }}</h2>
        </div>
        <ul class="list">
          {{ range $programsForTeacher }}
          <li>
            <div>
              <p>{{ safeHTML (index .Params.teachers_description $slug) }}</p>
            </div>
            <div>
              <a href="{{ .Permalink }}" class="link link--more">{{ safeHTML .Title }}</a>
            </div>
          </li>
          {{ end }}
        </ul>
      </section>
    {{ end }}

    {{ if $author.Pages }}
      <section class="mb-6">
        <div class="row">
          <div class="col-md-8">
            <h2>{{ i18n "persons.posts" }}</h2>
          </div>
          <div class="col-md-4">
            <a href="actualites/" class="link link--more">{{ i18n "posts.see_all" }}</a>
          </div>
        </div>
        <div class="row row-cols-1 row-cols-md-3 gy-5">
          {{ range first 3 $author.Pages }}
            <div class="col">
              {{ partial "posts/post.html" . }}
            </div>
          {{ end }}
        </div>
      </section>
    {{ end }}

    {{ if in .Params.roles "researcher" }}
      <a href="publications/">{{ i18n "persons.publications" }}</a>
    {{ end }}
  </div>
{{ end }}
